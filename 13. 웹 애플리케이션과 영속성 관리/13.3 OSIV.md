### OSIV (Open Session In View)
영속성 컨텍스트를 뷰까지 열어둔다는 뜻. 영속성 컨텍스트가 살아있으면 엔티티는 영속 상태로 유지된다. 따라서 뷰에서도 지연 로딩을 사용할 수 있다.

---

### 과거 OSIV : 요청 당 트랜잭션

![image](https://github.com/Drum-J/JPA_study/assets/102205699/88c57f34-ed8f-4f98-a21d-2c7af7e980e3)

가장 단순한 구현 방법은 클라이언트의 요청이 들어오자마자 서블릿 필터나 스프링 인터셉터에서 트랜잭션을 시작하고 요청이 끝날 때 트랜잭션도 끝나는 것.<br>
이것을 요청 당 트랜잭션 방식의 OSIV라 한다.

위 그림을 보면 알 수 있듯이 트랜잭션 범위와 영속성 컨텍스트 생존 범위가 Controller와 View 까지 늘어나 있는 것을 볼 수 있다.

하지만 이렇게 하면 컨트롤러나 뷰 같은 프리젠테이션 계층이 `엔티티를 변경할 수 있다는 문제점`을 가진다.

---

### 스프링 OSIV : 비즈니스 계층 트랜잭션
스프링 프레임워크가 제공하는 OSIV로 "비즈니스 계층에서 트랜잭션을 사용하는 OSIV".<br>
OSIV를 사용하지만 트랜잭션은 `비즈니스 계층`에서만 사용한다는 뜻이다.

![image](https://github.com/Drum-J/JPA_study/assets/102205699/1008c6bb-50cc-445d-97b1-d496db6a6063)

이 그림과 과거 OSIV 그림을 보면 딱 봐도 다른게 보인다.

과거 OSIV와 다른 점은 비즈니스 로직을 실행하고 서비스 계층이 끝나면 트랜잭션을 커밋하면서 영속성 컨텍스트를 플러시한다.<br>
이때 트랜잭션만 종료하고 영속성 컨텍스트는 살려둔다는게 다른점이다!! 이후 클라이언트의 요청이 끝날 때 영속성 컨텍스트도 종료한다.

