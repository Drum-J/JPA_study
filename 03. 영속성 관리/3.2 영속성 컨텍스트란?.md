### 영속성 컨텍스트 (Presistence Context)
JPA를 이해하는데 가장 중요한 용어.
<br>번역하기 조금 어렵지만 `엔티티를 영구 저장하는 환경`이라는 뜻이다.

EM으로 엔티티를 저장하거나 조회하면 EM은 영속성 컨텍스트에 엔티티를 보관하고 관리한다.

```java
em.persist(member);
```
이 코드가 저장한다고 표현했지만, 사실은 EM을 사용해서 회원 엔티티를 영속성 컨텍스트에 저장한다는 뜻이다.

>영속성 컨텍스트는 EM을 생성할 때 하나 만들어 진다.<br> EM을 통해서 영속성 컨텍스트에 접근,관리 할 수 있다.

---

### 3.3 엔티티의 생명주기
엔티티에는 4가지 상태가 존재한다.

1. 비영속(new/transient) : 영속성 컨텍스트와 전혀 관계가 없는 상태
2. 영속(managed) : 영속성 컨텍스트에 저장된 상태
3. 준영속(detached) : 영속성 컨텍스트에 저장되었다가 분리된 상태
4. 삭제(removed) : 삭제된 상태

#### 비영속
엔티티 객체를 생성, 지금은 순수한 객체 상태이며 아직 저장하지 않았다.
```java
//객체를 생성한 상태(비영속)
Member member = new Member();
member.setId();
member.setName();
```

영속성 컨텍스트나 DB와는 전혀 관련이 없다.

#### 영속
EM을 통해 엔티티를 영속성 컨텍스트에 저장. 이렇게 영속성 컨텍스트가 관리하는 엔티티를 `영속 상태` 라고 한다.
<br>결국 영속 상태라는 것은 영속성 컨텍스트에 의해 관리된다는 뜻이다.

```java
//객체를 저장한 상태(영속)
em.persist(member);
```
또한, `em.find()`나 JPQL을 사용해서 조회한 엔티티도 영속성 컨텍스트가 관리하는 영속 상태다.

#### 준영속
영속 상태의 엔티티를 영속성 컨텍스트가 관리하지 않으면 준영속 상태가 된다.
```java
em.detach(member) //회원 엔티티를 영속성 컨텍스트에서 분리, 준영속 상태
em.close() //닫기
em.clear() //초기화
```

세 개의 메소드 중 하나를 사용하면 된다. 특정 엔티티를 호출하는 `em.detach()`를 선호하는 모양

#### 삭제
엔티티를 영속성 컨텍스트와 DB에서 삭제한다.
```java
//객체를 삭제한 상태 (삭제)
em.remove(member);
```
