### 1차 캐시
1차 캐시는 영속성 컨텍스트 내부에 있다. 1차 캐시는 끄고 켤 수 있는 옵션이 아니다. 영속성 컨텍스트 자체가 사실상 1차 캐시이다.

> 특징
> - 1차 캐시는 같은 엔티티가 있으면 해당 엔티티를 그대로 반환한다. 따라서 1차 캐시는 객체 동일성(a == b)을 보장한다.
> - 1차 캐시는 기본적으로 영속성 컨텍스트 범위의 캐시. (컨테이너 환경 - 트랜잭션 범위의 캐시, OSIV - 요청 범위의 캐시)

---

### 2차 캐시
2차 캐시는 애플리케이션 범위의 캐시. 따라서 애플리케이션을 종료할 때까지 캐시가 유지된다.

2차 캐시를 적용하면 엔티티 매니저를 통해 데이터를 조회할 때 우선 2차 캐시에서 찾고 없으면 DB에서 찾는다. 2차 캐시를 적절히 활용하면 DB 조회 횟수를 획기적으로 줄일 수 있다.
<br>또 2차 캐시는 동시성을 극대화하려고 캐시한 객체를 직접 반환하지 않고 `복사본`을 만들어서 반환한다.

> 특징
> - 2차 캐시는 영속성 유닛 범위의 캐시
> - 2차 캐시는 조회한 객체를 그대로 반환하는 것이 아니라 복사본을 반환
> - 2차 캐시는 DB 기본 키를 기준으로 캐시하지만 영속성 컨텍스트가 다르면 객체 동일성(a == b)을 보장하지 않는다.

---

### JPA 2차 캐시 기능

2차 캐시를 사용하려면 엔티티에 `@Cacheable` 어노테이션을 사용하면 된다.

```java
//2차 캐시 설정
@Cacheable
@Entity
public class Member {
  ...
}
```
@Cacheable은 true와 false를 설정할 수 있는데 기본값은 true 이다.

이후 xml에 파일에 `shard-cache-mode`를 설정해서 애플리케이션 전체에 캐시를 어떻게 적용할지 옵션을 설정.

---

### 그 외에도
캐시 조회, 저장 방식 설정 / JPA 캐시 관리 API / 하이버네이트와 EHCACHE 적용 들은 책을 통해서 파악하자. p.712
